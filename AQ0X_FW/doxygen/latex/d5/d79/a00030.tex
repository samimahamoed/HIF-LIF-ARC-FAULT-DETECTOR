\hypertarget{a00030}{\section{srv\+\_\+serial.\+c File Reference}
\label{a00030}\index{srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}}
}


Serial port driver.  


{\ttfamily \#include \char`\"{}..\textbackslash{}includes\textbackslash{}allheaders.\+h\char`\"{}}\\*
Include dependency graph for srv\+\_\+serial.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=204pt]{da/d20/a01689}
\end{center}
\end{figure}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{a00030_d8/db4/a00760}{serial\+\_\+data\+\_\+t}
\begin{DoxyCompactList}\small\item\em Serial port internal data.  \hyperlink{a00030_d8/db4/a00760}{More...}\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{a00030_aca346e181d2ffc089e22e75736a6ff63}{B\+R\+G\+V\+A\+L}~((\hyperlink{a00072_a573f918b7668f8f2b59ac8adeae633a4}{F\+C\+Y\+\_\+\+C\+P\+U}/\hyperlink{a00031_a734bbab06e1a9fd2e5522db0221ff6e3}{B\+A\+U\+D\+R\+A\+T\+E})/16)-\/1
\begin{DoxyCompactList}\small\item\em Formula for U1\+B\+R\+G register ( baudrate control) \end{DoxyCompactList}\item 
\#define \hyperlink{a00030_a428b04d2e2f2da2ea031a6c731660a71}{H\+E\+X2\+V\+A\+L}(cc)~(((cc $>$= '0' ) \&\& (cc $<$= '9' )) ? (cc -\/ '0') \+: (cc -\/ 'A' + 10) )
\begin{DoxyCompactList}\small\item\em Charcter to hex value conversion. \end{DoxyCompactList}\item 
\#define \hyperlink{a00030_a70cf18090d97bf40a74a6ff7fd56d888}{C\+M\+D\+\_\+\+R\+E\+S\+P\+O\+N\+S\+E\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+S\+I\+Z\+E}~10
\item 
\#define \hyperlink{a00030_a7704c8abe93ef4188dd1562167bdbe63}{D\+A\+T\+A\+\_\+\+T\+X\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+S\+I\+Z\+E}~21
\item 
\#define \hyperlink{a00030_ae744e762e849a4701bf982655b5dc2db}{T\+X\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+F\+R\+A\+M\+E\+\_\+\+C\+H\+A\+R}~'\{'
\item 
\#define \hyperlink{a00030_a5470c21188de014a742af7a64aeb23a0}{R\+C\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+F\+R\+A\+M\+E\+\_\+\+C\+H\+A\+R}~'\mbox{[}'
\item 
\#define \hyperlink{a00030_a2c59f95209427bfe2c53a30515cfbeda}{A\+C\+K\+\_\+\+C\+H\+A\+R}~\char`\"{}06\char`\"{}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{a00030_ad2b461e9e9044364a28a61cfadcacdd8}{serial\+\_\+init} (void)
\begin{DoxyCompactList}\small\item\em Init function for srv\+\_\+serial service. \end{DoxyCompactList}\item 
void \hyperlink{a00030_af15ca641f181de14f789d97b00c367ef}{serial\+\_\+enable\+\_\+blocking} (int enable)
\begin{DoxyCompactList}\small\item\em Init function for srv\+\_\+serial service. \end{DoxyCompactList}\item 
\hyperlink{a00072_af84840501dec18061d18a68c162a8fa2}{Uint8} \hyperlink{a00030_a366b2707f4c7d76f0efc1b5cdde8e37e}{serial\+\_\+get\+\_\+command} (\hyperlink{a00072_a59a9f6be4562c327cbfb4f7e8e18f08b}{Uint16} $\ast$cmd, \hyperlink{a00072_af84840501dec18061d18a68c162a8fa2}{Uint8} $\ast$$\ast$arg\+Str\+Ptr, \hyperlink{a00072_a59a9f6be4562c327cbfb4f7e8e18f08b}{Uint16} $\ast$arg\+Length)
\begin{DoxyCompactList}\small\item\em Function for retriving serial message. \end{DoxyCompactList}\item 
void \hyperlink{a00030_a7fc7421ed15d6e4516e9878e7455d715}{serial\+\_\+get\+\_\+command\+\_\+ack} (void)
\begin{DoxyCompactList}\small\item\em Function which marks serial buffer as processed, so new command can be taken. \end{DoxyCompactList}\item 
\hyperlink{a00072_af84840501dec18061d18a68c162a8fa2}{Uint8} \hyperlink{a00030_aa76f5237babd71f1484bb2dbc6aa0f8d}{serial\+\_\+make8} (\hyperlink{a00072_af84840501dec18061d18a68c162a8fa2}{Uint8} $\ast$buf, \hyperlink{a00072_a59a9f6be4562c327cbfb4f7e8e18f08b}{Uint16} idx)
\begin{DoxyCompactList}\small\item\em Function converting characters to 8 bit value. \end{DoxyCompactList}\item 
\hyperlink{a00072_a59a9f6be4562c327cbfb4f7e8e18f08b}{Uint16} \hyperlink{a00030_abc17de32f14103a5be219df0d4ad9176}{serial\+\_\+make16} (\hyperlink{a00072_af84840501dec18061d18a68c162a8fa2}{Uint8} $\ast$buf, \hyperlink{a00072_a59a9f6be4562c327cbfb4f7e8e18f08b}{Uint16} idx)
\begin{DoxyCompactList}\small\item\em Function converting characters to 16 bit value. \end{DoxyCompactList}\item 
void \hyperlink{a00030_a96a3f016ca5b0736424c2695fe9fbdf8}{serial\+\_\+send\+\_\+response} (\hyperlink{a00031_d3/d4f/a00761}{serial\+\_\+msg\+\_\+t} msg)
\begin{DoxyCompactList}\small\item\em Function sending command responses on serial line. \end{DoxyCompactList}\item 
void \hyperlink{a00030_a17f65cf9dbacdfb97cb2536ed0097ccb}{serial\+\_\+send} (void $\ast$msg, \hyperlink{a00072_a59a9f6be4562c327cbfb4f7e8e18f08b}{Uint16} length)
\begin{DoxyCompactList}\small\item\em Function sending buffers over serial port. \end{DoxyCompactList}\item 
void \hyperlink{a00030_a2068c3c2584547dbc1c8b9bca2d55b18}{\+\_\+\+\_\+attribute\+\_\+\+\_\+} ((\+\_\+\+\_\+interrupt\+\_\+\+\_\+, auto\+\_\+psv))
\begin{DoxyCompactList}\small\item\em Serial port receive interrupt. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{a00022_da/dc3/a00657}{pre\+\_\+act\+\_\+record\+\_\+buffer\+\_\+t} \hyperlink{a00030_a448db071f92912b830a4aabd08c45d0c}{pre\+\_\+data}
\item 
volatile \hyperlink{a00030_d8/db4/a00760}{serial\+\_\+data\+\_\+t} \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\+\_\+data}
\begin{DoxyCompactList}\small\item\em srv\+\_\+serial service internal data \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Serial port driver. 



Definition in file \hyperlink{a00030_source}{srv\+\_\+serial.\+c}.



\subsection{Data Structure Documentation}
\index{serial\+\_\+data\+\_\+t@{serial\+\_\+data\+\_\+t}}\label{d8/db4/a00760}
\hypertarget{a00030_d8/db4/a00760}{}
\subsubsection{struct serial\+\_\+data\+\_\+t}
Serial port internal data. 

Definition at line \hyperlink{a00030_source_l00028}{28} of file \hyperlink{a00030_source}{srv\+\_\+serial.\+c}.



Collaboration diagram for serial\+\_\+data\+\_\+t\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/d01/a01690}
\end{center}
\end{figure}
\begin{DoxyFields}{Data Fields}
\hypertarget{a00030_a758ac775caab1899af08024d4635f7e3}{int}\label{a00030_a758ac775caab1899af08024d4635f7e3}
&
blocking\+\_\+mode&
If set, then serial sending is blocking ( no data lost) Otherwise, characters which do not fit into buffer are ignored. \\
\hline

\hypertarget{a00030_a15d632931355763426453b626cab774b}{\hyperlink{a00072_a59a9f6be4562c327cbfb4f7e8e18f08b}{Uint16}}\label{a00030_a15d632931355763426453b626cab774b}
&
irq\+\_\+cnt&
\\
\hline

\hypertarget{a00030_ac0789a6c9ab7ccd13d6f04ae31496854}{\hyperlink{a00072_af84840501dec18061d18a68c162a8fa2}{Uint8}}\label{a00030_ac0789a6c9ab7ccd13d6f04ae31496854}
&
msg\+\_\+ready&
If set, received message was collected. \\
\hline

\hypertarget{a00030_ac734cb8be27f86bd99edc539434883a4}{\hyperlink{a00072_af84840501dec18061d18a68c162a8fa2}{Uint8}}\label{a00030_ac734cb8be27f86bd99edc539434883a4}
&
rc\+\_\+buffer\mbox{[}\hyperlink{a00031_aa49ab378520c95fea987f93a7f3c9abf}{R\+E\+C\+E\+I\+V\+E\+\_\+\+B\+U\+F\+F\+E\+R\+\_\+\+S\+I\+Z\+E}\mbox{]}&
Receive buffer. \\
\hline

\hypertarget{a00030_a51eacf0fe4dbe4cfbdaf0aaa63693013}{\hyperlink{a00072_a59a9f6be4562c327cbfb4f7e8e18f08b}{Uint16}}\label{a00030_a51eacf0fe4dbe4cfbdaf0aaa63693013}
&
rc\+\_\+cnt&
Diagnostic counter -\/ received message count. \\
\hline

\hypertarget{a00030_ab136d4fef2c523afd55b6ca74c46d7cc}{\hyperlink{a00072_a59a9f6be4562c327cbfb4f7e8e18f08b}{Uint16}}\label{a00030_ab136d4fef2c523afd55b6ca74c46d7cc}
&
rc\+\_\+data\+\_\+length&
Recevied message length. \\
\hline

\hypertarget{a00030_a3e2eda0a020422511de91b2bc7386083}{\hyperlink{a00072_a59a9f6be4562c327cbfb4f7e8e18f08b}{Uint16}}\label{a00030_a3e2eda0a020422511de91b2bc7386083}
&
tx\+\_\+buff\+\_\+head&
Transmit buffer head. \\
\hline

\hypertarget{a00030_a6287e1447d7902b8bbc2f6359065dcbd}{\hyperlink{a00072_a59a9f6be4562c327cbfb4f7e8e18f08b}{Uint16}}\label{a00030_a6287e1447d7902b8bbc2f6359065dcbd}
&
tx\+\_\+buff\+\_\+tail&
Transmit buffer tail. \\
\hline

\hypertarget{a00030_a327864d2719b5145f0eded883fe321c5}{\hyperlink{a00072_af84840501dec18061d18a68c162a8fa2}{Uint8}}\label{a00030_a327864d2719b5145f0eded883fe321c5}
&
tx\+\_\+buffer\mbox{[}\hyperlink{a00031_aef714b16a48390956c10e8aa18d156b8}{T\+R\+A\+N\+S\+M\+I\+T\+\_\+\+B\+U\+F\+F\+E\+R\+\_\+\+S\+I\+Z\+E}\mbox{]}&
Transmit buffer ( circular) \\
\hline

\hypertarget{a00030_ab6b71c720d341035fb26d723364eb879}{\hyperlink{a00072_a59a9f6be4562c327cbfb4f7e8e18f08b}{Uint16}}\label{a00030_ab6b71c720d341035fb26d723364eb879}
&
tx\+\_\+cnt&
Diagnostic counter -\/ transmit message count. \\
\hline

\end{DoxyFields}


\subsection{Macro Definition Documentation}
\hypertarget{a00030_a2c59f95209427bfe2c53a30515cfbeda}{\index{srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}!A\+C\+K\+\_\+\+C\+H\+A\+R@{A\+C\+K\+\_\+\+C\+H\+A\+R}}
\index{A\+C\+K\+\_\+\+C\+H\+A\+R@{A\+C\+K\+\_\+\+C\+H\+A\+R}!srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}}
\subsubsection[{A\+C\+K\+\_\+\+C\+H\+A\+R}]{\setlength{\rightskip}{0pt plus 5cm}\#define A\+C\+K\+\_\+\+C\+H\+A\+R~\char`\"{}06\char`\"{}}}\label{a00030_a2c59f95209427bfe2c53a30515cfbeda}


Definition at line \hyperlink{a00030_source_l00022}{22} of file \hyperlink{a00030_source}{srv\+\_\+serial.\+c}.

\hypertarget{a00030_aca346e181d2ffc089e22e75736a6ff63}{\index{srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}!B\+R\+G\+V\+A\+L@{B\+R\+G\+V\+A\+L}}
\index{B\+R\+G\+V\+A\+L@{B\+R\+G\+V\+A\+L}!srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}}
\subsubsection[{B\+R\+G\+V\+A\+L}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\+R\+G\+V\+A\+L~(({\bf F\+C\+Y\+\_\+\+C\+P\+U}/{\bf B\+A\+U\+D\+R\+A\+T\+E})/16)-\/1}}\label{a00030_aca346e181d2ffc089e22e75736a6ff63}


Formula for U1\+B\+R\+G register ( baudrate control) 



Definition at line \hyperlink{a00030_source_l00013}{13} of file \hyperlink{a00030_source}{srv\+\_\+serial.\+c}.



Referenced by \hyperlink{a00030_source_l00159}{serial\+\_\+init()}.

\hypertarget{a00030_a70cf18090d97bf40a74a6ff7fd56d888}{\index{srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}!C\+M\+D\+\_\+\+R\+E\+S\+P\+O\+N\+S\+E\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+S\+I\+Z\+E@{C\+M\+D\+\_\+\+R\+E\+S\+P\+O\+N\+S\+E\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+S\+I\+Z\+E}}
\index{C\+M\+D\+\_\+\+R\+E\+S\+P\+O\+N\+S\+E\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+S\+I\+Z\+E@{C\+M\+D\+\_\+\+R\+E\+S\+P\+O\+N\+S\+E\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+S\+I\+Z\+E}!srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}}
\subsubsection[{C\+M\+D\+\_\+\+R\+E\+S\+P\+O\+N\+S\+E\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+S\+I\+Z\+E}]{\setlength{\rightskip}{0pt plus 5cm}\#define C\+M\+D\+\_\+\+R\+E\+S\+P\+O\+N\+S\+E\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+S\+I\+Z\+E~10}}\label{a00030_a70cf18090d97bf40a74a6ff7fd56d888}


Definition at line \hyperlink{a00030_source_l00018}{18} of file \hyperlink{a00030_source}{srv\+\_\+serial.\+c}.

\hypertarget{a00030_a7704c8abe93ef4188dd1562167bdbe63}{\index{srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}!D\+A\+T\+A\+\_\+\+T\+X\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+S\+I\+Z\+E@{D\+A\+T\+A\+\_\+\+T\+X\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+S\+I\+Z\+E}}
\index{D\+A\+T\+A\+\_\+\+T\+X\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+S\+I\+Z\+E@{D\+A\+T\+A\+\_\+\+T\+X\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+S\+I\+Z\+E}!srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}}
\subsubsection[{D\+A\+T\+A\+\_\+\+T\+X\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+S\+I\+Z\+E}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\+A\+T\+A\+\_\+\+T\+X\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+S\+I\+Z\+E~21}}\label{a00030_a7704c8abe93ef4188dd1562167bdbe63}


Definition at line \hyperlink{a00030_source_l00019}{19} of file \hyperlink{a00030_source}{srv\+\_\+serial.\+c}.

\hypertarget{a00030_a428b04d2e2f2da2ea031a6c731660a71}{\index{srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}!H\+E\+X2\+V\+A\+L@{H\+E\+X2\+V\+A\+L}}
\index{H\+E\+X2\+V\+A\+L@{H\+E\+X2\+V\+A\+L}!srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}}
\subsubsection[{H\+E\+X2\+V\+A\+L}]{\setlength{\rightskip}{0pt plus 5cm}\#define H\+E\+X2\+V\+A\+L(
\begin{DoxyParamCaption}
\item[{}]{cc}
\end{DoxyParamCaption}
)~(((cc $>$= '0' ) \&\& (cc $<$= '9' )) ? (cc -\/ '0') \+: (cc -\/ 'A' + 10) )}}\label{a00030_a428b04d2e2f2da2ea031a6c731660a71}


Charcter to hex value conversion. 



Definition at line \hyperlink{a00030_source_l00016}{16} of file \hyperlink{a00030_source}{srv\+\_\+serial.\+c}.



Referenced by \hyperlink{a00030_source_l00381}{serial\+\_\+make16()}, and \hyperlink{a00030_source_l00367}{serial\+\_\+make8()}.

\hypertarget{a00030_a5470c21188de014a742af7a64aeb23a0}{\index{srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}!R\+C\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+F\+R\+A\+M\+E\+\_\+\+C\+H\+A\+R@{R\+C\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+F\+R\+A\+M\+E\+\_\+\+C\+H\+A\+R}}
\index{R\+C\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+F\+R\+A\+M\+E\+\_\+\+C\+H\+A\+R@{R\+C\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+F\+R\+A\+M\+E\+\_\+\+C\+H\+A\+R}!srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}}
\subsubsection[{R\+C\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+F\+R\+A\+M\+E\+\_\+\+C\+H\+A\+R}]{\setlength{\rightskip}{0pt plus 5cm}\#define R\+C\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+F\+R\+A\+M\+E\+\_\+\+C\+H\+A\+R~'\mbox{[}'}}\label{a00030_a5470c21188de014a742af7a64aeb23a0}


Definition at line \hyperlink{a00030_source_l00021}{21} of file \hyperlink{a00030_source}{srv\+\_\+serial.\+c}.

\hypertarget{a00030_ae744e762e849a4701bf982655b5dc2db}{\index{srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}!T\+X\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+F\+R\+A\+M\+E\+\_\+\+C\+H\+A\+R@{T\+X\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+F\+R\+A\+M\+E\+\_\+\+C\+H\+A\+R}}
\index{T\+X\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+F\+R\+A\+M\+E\+\_\+\+C\+H\+A\+R@{T\+X\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+F\+R\+A\+M\+E\+\_\+\+C\+H\+A\+R}!srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}}
\subsubsection[{T\+X\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+F\+R\+A\+M\+E\+\_\+\+C\+H\+A\+R}]{\setlength{\rightskip}{0pt plus 5cm}\#define T\+X\+\_\+\+M\+S\+G\+\_\+\+H\+E\+A\+D\+E\+R\+\_\+\+F\+R\+A\+M\+E\+\_\+\+C\+H\+A\+R~'\{'}}\label{a00030_ae744e762e849a4701bf982655b5dc2db}


Definition at line \hyperlink{a00030_source_l00020}{20} of file \hyperlink{a00030_source}{srv\+\_\+serial.\+c}.



\subsection{Function Documentation}
\hypertarget{a00030_a2068c3c2584547dbc1c8b9bca2d55b18}{\index{srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}!\+\_\+\+\_\+attribute\+\_\+\+\_\+@{\+\_\+\+\_\+attribute\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+attribute\+\_\+\+\_\+@{\+\_\+\+\_\+attribute\+\_\+\+\_\+}!srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}}
\subsubsection[{\+\_\+\+\_\+attribute\+\_\+\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}void \+\_\+\+\_\+attribute\+\_\+\+\_\+ (
\begin{DoxyParamCaption}
\item[{(\+\_\+\+\_\+interrupt\+\_\+\+\_\+, auto\+\_\+psv)}]{}
\end{DoxyParamCaption}
)}}\label{a00030_a2068c3c2584547dbc1c8b9bca2d55b18}


Serial port receive interrupt. 

Serial port transmit interrupt.req R\+E\+Q-\/8a\+: \char`\"{}\+Read the sensor inputs \char`\"{} Sensors and inputs are read and filtered.

Definition at line \hyperlink{a00030_source_l00658}{658} of file \hyperlink{a00030_source}{srv\+\_\+serial.\+c}.



References \hyperlink{a00038_source_l02104}{algorithm\+\_\+message\+\_\+arrived\+\_\+ntf\+\_\+isr()}, \hyperlink{a00030_source_l00054}{serial\+\_\+data\+\_\+t\+::irq\+\_\+cnt}, \hyperlink{a00021_source_l00058}{I\+R\+Q\+\_\+\+S\+O\+U\+R\+C\+E\+\_\+\+S\+E\+R\+I\+A\+L}, \hyperlink{a00030_source_l00035}{serial\+\_\+data\+\_\+t\+::msg\+\_\+ready}, \hyperlink{a00030_source_l00031}{serial\+\_\+data\+\_\+t\+::rc\+\_\+buffer}, \hyperlink{a00030_source_l00033}{serial\+\_\+data\+\_\+t\+::rc\+\_\+data\+\_\+length}, \hyperlink{a00015_source_l08162}{S\+E\+T\+\_\+\+C\+P\+U\+\_\+\+I\+P\+L}, and \hyperlink{a00067_source_l00028}{srv\+\_\+wdg\+\_\+kick}.


\begin{DoxyCode}
00660 \{
00661      
00662 
00663      
00664     \hyperlink{a00072_af84840501dec18061d18a68c162a8fa2}{Uint8} cc;
00665     
00666     
00667    \hyperlink{a00067_a710d148845397582739d170341f3d3d9}{srv\_wdg\_kick}();
00668    
00669 
00670 
00671    
00672   \textcolor{keywordflow}{while} (U1STAbits.URXDA != 0)
00673     \{
00674         
00675         \textcolor{keywordflow}{if}( (U1STAbits.FERR)||(U1STAbits.PERR))
00676         \{
00677             cc = U1RXREG;
00678             \textcolor{keywordflow}{continue};
00679         \}
00680 
00681      
00682         cc = U1RXREG;
00683     
00684       
00685 
00686         \textcolor{keywordflow}{if}(\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ac0789a6c9ab7ccd13d6f04ae31496854}{msg\_ready} != 0)
00687         \{
00688             \textcolor{comment}{// Ignore messages until the old one is processed}
00689             \textcolor{keywordflow}{continue};
00690         \}
00691 
00692         \textcolor{keywordflow}{if}(\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ab136d4fef2c523afd55b6ca74c46d7cc}{rc\_data\_length} >= \textcolor{keyword}{sizeof}(
      \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ac734cb8be27f86bd99edc539434883a4}{rc\_buffer}))
00693         \{
00694             \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ab136d4fef2c523afd55b6ca74c46d7cc}{rc\_data\_length} = 0;
00695         \}
00696 
00697    
00698         \textcolor{keywordflow}{if}(cc == \textcolor{charliteral}{'['} )
00699         \{
00700             \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ab136d4fef2c523afd55b6ca74c46d7cc}{rc\_data\_length} = 0;
00701             \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ac734cb8be27f86bd99edc539434883a4}{rc\_buffer}[\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.
      \hyperlink{a00030_ab136d4fef2c523afd55b6ca74c46d7cc}{rc\_data\_length}++] = cc;
00702         \}
00703         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (cc == \textcolor{charliteral}{']'})
00704         \{
00705             \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ac734cb8be27f86bd99edc539434883a4}{rc\_buffer}[\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.
      \hyperlink{a00030_ab136d4fef2c523afd55b6ca74c46d7cc}{rc\_data\_length}++] = cc;
00706 
00707             \textcolor{comment}{// Full message arrived}
00708             \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ac0789a6c9ab7ccd13d6f04ae31496854}{msg\_ready} = 1;
00709             \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_a15d632931355763426453b626cab774b}{irq\_cnt}++;
00710         \}
00711         \textcolor{keywordflow}{else}
00712         \{        
00713             \textcolor{keywordflow}{if} ( ((cc >= \textcolor{charliteral}{'0'})&&(cc <= \textcolor{charliteral}{'9'})) || ((cc >= \textcolor{charliteral}{'A'})&&(cc <= \textcolor{charliteral}{'F'})) || ( cc == \textcolor{charliteral}{':'}) )
00714             \{
00715                 \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ac734cb8be27f86bd99edc539434883a4}{rc\_buffer}[\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.
      \hyperlink{a00030_ab136d4fef2c523afd55b6ca74c46d7cc}{rc\_data\_length}++] = cc;
00716             \}
00717             \textcolor{keywordflow}{else}
00718             \{
00719                 \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ab136d4fef2c523afd55b6ca74c46d7cc}{rc\_data\_length} = 0;
00720             \}                          
00721         \}
00722     
00723     \}
00724     
00725     \textcolor{comment}{// Clear errors}
00726     \textcolor{keywordflow}{if}(U1STAbits.OERR)
00727     \{
00728         U1STAbits.OERR = 0;
00729     \}
00730          
00731 
00732 
00733 
00734 
00735 
00736 
00737 
00738     \textcolor{keywordflow}{if}((\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ac0789a6c9ab7ccd13d6f04ae31496854}{msg\_ready} == 1)&&(\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.
      \hyperlink{a00030_ac734cb8be27f86bd99edc539434883a4}{rc\_buffer}[0]==\textcolor{charliteral}{'['}))
00739          \hyperlink{a00021_a85471d58eae93d5d7e7e2b52e2b915d3}{algorithm\_message\_arrived\_ntf\_isr}(
      \hyperlink{a00021_a286de80383de54438b3e38d9f149dfd0}{IRQ\_SOURCE\_SERIAL});
00740            
00741   
00742  
00743     
00744     IFS0bits.U1RXIF = 0;  
00745 
00746     \hyperlink{a00015_a34d4c80d85281a545f3c7f1530803d65}{SET\_CPU\_IPL}(7);
00747 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d79/a00030_a2068c3c2584547dbc1c8b9bca2d55b18_cgraph}
\end{center}
\end{figure}


\hypertarget{a00030_af15ca641f181de14f789d97b00c367ef}{\index{srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}!serial\+\_\+enable\+\_\+blocking@{serial\+\_\+enable\+\_\+blocking}}
\index{serial\+\_\+enable\+\_\+blocking@{serial\+\_\+enable\+\_\+blocking}!srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}}
\subsubsection[{serial\+\_\+enable\+\_\+blocking}]{\setlength{\rightskip}{0pt plus 5cm}void serial\+\_\+enable\+\_\+blocking (
\begin{DoxyParamCaption}
\item[{int}]{enable}
\end{DoxyParamCaption}
)}}\label{a00030_af15ca641f181de14f789d97b00c367ef}


Init function for srv\+\_\+serial service. 



Definition at line \hyperlink{a00030_source_l00219}{219} of file \hyperlink{a00030_source}{srv\+\_\+serial.\+c}.



References \hyperlink{a00030_source_l00039}{serial\+\_\+data\+\_\+t\+::blocking\+\_\+mode}.



Referenced by \hyperlink{a00030_source_l00159}{serial\+\_\+init()}.


\begin{DoxyCode}
00220 \{
00221         \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_a758ac775caab1899af08024d4635f7e3}{blocking\_mode} = enable;
00222 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d79/a00030_af15ca641f181de14f789d97b00c367ef_icgraph}
\end{center}
\end{figure}


\hypertarget{a00030_a366b2707f4c7d76f0efc1b5cdde8e37e}{\index{srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}!serial\+\_\+get\+\_\+command@{serial\+\_\+get\+\_\+command}}
\index{serial\+\_\+get\+\_\+command@{serial\+\_\+get\+\_\+command}!srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}}
\subsubsection[{serial\+\_\+get\+\_\+command}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Uint8} serial\+\_\+get\+\_\+command (
\begin{DoxyParamCaption}
\item[{{\bf Uint16} $\ast$}]{cmd, }
\item[{{\bf Uint8} $\ast$$\ast$}]{arg\+Str\+Ptr, }
\item[{{\bf Uint16} $\ast$}]{arg\+Length}
\end{DoxyParamCaption}
)}}\label{a00030_a366b2707f4c7d76f0efc1b5cdde8e37e}


Function for retriving serial message. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em cmd} & response command \\
\hline
\mbox{\tt in,out}  & {\em arg\+Str\+Ptr} & pointer to be updated with argument buffer \\
\hline
\mbox{\tt in,out}  & {\em arg\+Length} & pointer for argument buffer length \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{a00030_source_l00263}{263} of file \hyperlink{a00030_source}{srv\+\_\+serial.\+c}.



References \hyperlink{a00060_source_l00084}{crc16()}, \hyperlink{a00030_source_l00035}{serial\+\_\+data\+\_\+t\+::msg\+\_\+ready}, \hyperlink{a00030_source_l00031}{serial\+\_\+data\+\_\+t\+::rc\+\_\+buffer}, \hyperlink{a00030_source_l00033}{serial\+\_\+data\+\_\+t\+::rc\+\_\+data\+\_\+length}, \hyperlink{a00030_source_l00343}{serial\+\_\+get\+\_\+command\+\_\+ack()}, and \hyperlink{a00030_source_l00381}{serial\+\_\+make16()}.


\begin{DoxyCode}
00264 \{
00265     \hyperlink{a00072_af84840501dec18061d18a68c162a8fa2}{Uint8} result = 1;
00266     \hyperlink{a00072_a59a9f6be4562c327cbfb4f7e8e18f08b}{Uint16} crc,calc\_crc = 0;
00267    
00268 
00269     
00270 
00271     \textcolor{keywordflow}{if}(\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ac0789a6c9ab7ccd13d6f04ae31496854}{msg\_ready} != 0)
00272     \{
00273 
00274         \textcolor{comment}{// Minimal message - 16 characters}
00275         \textcolor{comment}{// [0000:000000:00]}
00276         \textcolor{comment}{// 01234567890123}
00277         \textcolor{comment}{// 00000000001111}
00278         \textcolor{comment}{// Longer messages look like}
00279         \textcolor{comment}{// [0000:000000000000000  ... 00000000000:00]}
00280 
00281 
00282         \textcolor{keywordflow}{if}(\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ab136d4fef2c523afd55b6ca74c46d7cc}{rc\_data\_length} >= 14 )
00283         \{
00284 
00285             *cmd = \hyperlink{a00030_abc17de32f14103a5be219df0d4ad9176}{serial\_make16}((\hyperlink{a00072_af84840501dec18061d18a68c162a8fa2}{Uint8}*)\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.
      \hyperlink{a00030_ac734cb8be27f86bd99edc539434883a4}{rc\_buffer},1);
00286 
00287             \textcolor{keywordflow}{if}( (\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ac734cb8be27f86bd99edc539434883a4}{rc\_buffer}[\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.
      \hyperlink{a00030_ab136d4fef2c523afd55b6ca74c46d7cc}{rc\_data\_length}-5]==\textcolor{charliteral}{'C'}) && (\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ac734cb8be27f86bd99edc539434883a4}{rc\_buffer}[
      \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ab136d4fef2c523afd55b6ca74c46d7cc}{rc\_data\_length}-4]==\textcolor{charliteral}{'C'}))
00288             \{
00289                 \textcolor{comment}{// Manual mode, "CCCC" charaters instead of checksum}
00290                 result = 0;
00291             \}
00292             \textcolor{keywordflow}{else}
00293             \{
00294 
00295                 
00296                 crc  = \hyperlink{a00030_abc17de32f14103a5be219df0d4ad9176}{serial\_make16}((\hyperlink{a00072_af84840501dec18061d18a68c162a8fa2}{Uint8}*)\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.
      \hyperlink{a00030_ac734cb8be27f86bd99edc539434883a4}{rc\_buffer},\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ab136d4fef2c523afd55b6ca74c46d7cc}{rc\_data\_length}-5);
00297                 
00298            
00299                 calc\_crc = \hyperlink{a00021_a6553827687db2137ee550ad6e1d2f316}{crc16}((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char}*)\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.
      \hyperlink{a00030_ac734cb8be27f86bd99edc539434883a4}{rc\_buffer},\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ab136d4fef2c523afd55b6ca74c46d7cc}{rc\_data\_length}-6);
00300               \textcolor{comment}{/*}
00301 \textcolor{comment}{                for(ii = 0; ii < 11;ii++)}
00302 \textcolor{comment}{                \{}
00303 \textcolor{comment}{                    calc\_crc = calc\_crc ^serial\_data.rc\_buffer[ii];}
00304 \textcolor{comment}{                \}}
00305 \textcolor{comment}{              */}
00306                 \textcolor{keywordflow}{if}(crc == calc\_crc)
00307                 \{
00308                     result = 0;
00309                 \}
00310             \}
00311 
00312             *argStrPtr =  ((\hyperlink{a00072_af84840501dec18061d18a68c162a8fa2}{Uint8}*)&\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ac734cb8be27f86bd99edc539434883a4}{rc\_buffer}[6]);
00313             *argLength = \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ab136d4fef2c523afd55b6ca74c46d7cc}{rc\_data\_length} - 12;
00314 
00315        \}
00316 
00317        \textcolor{keywordflow}{if}(result != 0)
00318        \{
00319             \textcolor{comment}{// Faulty message, internmal ack}
00320             \hyperlink{a00030_a7fc7421ed15d6e4516e9878e7455d715}{serial\_get\_command\_ack}();
00321        \}
00322 
00323     \}
00324 
00325 
00326 
00327 
00328     IEC0bits.U1RXIE = 1;
00329 
00330 
00331     \textcolor{keywordflow}{return} result;
00332 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d79/a00030_a366b2707f4c7d76f0efc1b5cdde8e37e_cgraph}
\end{center}
\end{figure}


\hypertarget{a00030_a7fc7421ed15d6e4516e9878e7455d715}{\index{srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}!serial\+\_\+get\+\_\+command\+\_\+ack@{serial\+\_\+get\+\_\+command\+\_\+ack}}
\index{serial\+\_\+get\+\_\+command\+\_\+ack@{serial\+\_\+get\+\_\+command\+\_\+ack}!srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}}
\subsubsection[{serial\+\_\+get\+\_\+command\+\_\+ack}]{\setlength{\rightskip}{0pt plus 5cm}void serial\+\_\+get\+\_\+command\+\_\+ack (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{a00030_a7fc7421ed15d6e4516e9878e7455d715}


Function which marks serial buffer as processed, so new command can be taken. 



Definition at line \hyperlink{a00030_source_l00343}{343} of file \hyperlink{a00030_source}{srv\+\_\+serial.\+c}.



References \hyperlink{a00030_source_l00035}{serial\+\_\+data\+\_\+t\+::msg\+\_\+ready}, and \hyperlink{a00030_source_l00033}{serial\+\_\+data\+\_\+t\+::rc\+\_\+data\+\_\+length}.



Referenced by \hyperlink{a00030_source_l00263}{serial\+\_\+get\+\_\+command()}, and \hyperlink{a00030_source_l00159}{serial\+\_\+init()}.


\begin{DoxyCode}
00344 \{
00345     IEC0bits.U1RXIE = 0;
00346     \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ab136d4fef2c523afd55b6ca74c46d7cc}{rc\_data\_length} = 0;
00347     \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ac0789a6c9ab7ccd13d6f04ae31496854}{msg\_ready} = 0;
00348     IEC0bits.U1RXIE = 1;
00349 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d79/a00030_a7fc7421ed15d6e4516e9878e7455d715_icgraph}
\end{center}
\end{figure}


\hypertarget{a00030_ad2b461e9e9044364a28a61cfadcacdd8}{\index{srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}!serial\+\_\+init@{serial\+\_\+init}}
\index{serial\+\_\+init@{serial\+\_\+init}!srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}}
\subsubsection[{serial\+\_\+init}]{\setlength{\rightskip}{0pt plus 5cm}void serial\+\_\+init (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}}\label{a00030_ad2b461e9e9044364a28a61cfadcacdd8}


Init function for srv\+\_\+serial service. 



Definition at line \hyperlink{a00030_source_l00159}{159} of file \hyperlink{a00030_source}{srv\+\_\+serial.\+c}.



References \hyperlink{a00030_source_l00013}{B\+R\+G\+V\+A\+L}, \hyperlink{a00040_source_l00086}{F\+A\+L\+S\+E}, \hyperlink{a00030_source_l00033}{serial\+\_\+data\+\_\+t\+::rc\+\_\+data\+\_\+length}, \hyperlink{a00030_source_l00219}{serial\+\_\+enable\+\_\+blocking()}, \hyperlink{a00030_source_l00343}{serial\+\_\+get\+\_\+command\+\_\+ack()}, \hyperlink{a00040_source_l00084}{T\+R\+U\+E}, \hyperlink{a00030_source_l00044}{serial\+\_\+data\+\_\+t\+::tx\+\_\+buff\+\_\+head}, and \hyperlink{a00030_source_l00046}{serial\+\_\+data\+\_\+t\+::tx\+\_\+buff\+\_\+tail}.



Referenced by \hyperlink{a00048_source_l00080}{main()}.


\begin{DoxyCode}
00160 \{
00161 
00162     \textcolor{comment}{//gpio configuration and peripheral mapping procedure}
00163          \_\_builtin\_write\_OSCCONL(OSCCON & 0xbf);
00164              TRISBbits.TRISB10 = 1;
00165              ODCBbits.ODCB11   = 0;
00166              TRISBbits.TRISB11 = 0;
00167       
00168         
00169              RPOR4bits.RP43R   = 1; \textcolor{comment}{//TX1}
00170              RPINR18bits.U1RXR = 0x2A;
00171          \_\_builtin\_write\_OSCCONL(OSCCON | 0x40);
00172 
00173 
00174     U1MODE = 0x0000;            \textcolor{comment}{//Clear UART1 registers}
00175     U1STA  = 0x0000;
00176 
00177     U1MODEbits.UARTEN = 1;      \textcolor{comment}{//Enable UART1 module}
00178     U1MODEbits.PDSEL  = 0;      \textcolor{comment}{// 8 bits, no parity}
00179     U1MODEbits.STSEL  = 0;      \textcolor{comment}{// 1 stop bit}
00180 
00181     U1BRG = \hyperlink{a00030_aca346e181d2ffc089e22e75736a6ff63}{BRGVAL};             \textcolor{comment}{//Load UART1 Baud Rate Generator}
00182 
00183     IFS0bits.U1RXIF   = 0;      \textcolor{comment}{//Clear UART1 Receiver Interrupt Flag}
00184     IFS0bits.U1TXIF   = 0;      \textcolor{comment}{//Clear UART1 Transmitter Interrupt Flag}
00185     IEC0bits.U1RXIE   = 1;      \textcolor{comment}{//Enable UART1 Receiver Interrupt}
00186     IEC0bits.U1TXIE   = 1;      \textcolor{comment}{//Enable UART1 Transmitter Interrupt}
00187 
00188     U1STAbits.UTXISEL0 = 0;     \textcolor{comment}{// Interrupt after one TX character is transmitted}
00189     U1STAbits.UTXISEL1 = 0;
00190     U1STAbits.UTXINV   = 0;     \textcolor{comment}{// U1TX Idle state high}
00191 
00192     U1STAbits.URXISEL  = 1;     \textcolor{comment}{//Setup UART1  receiver to interrupt after character received}
00193     IPC2bits.U1RXIP    = 0x07;
00194     
00195 
00196     U1MODEbits.UARTEN  = 1;     \textcolor{comment}{// Enable UART}
00197 
00198     serial\_enable\_transmitter(\hyperlink{a00040_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
00199     
00200 
00201     \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ab136d4fef2c523afd55b6ca74c46d7cc}{rc\_data\_length} = 0;
00202     \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_a3e2eda0a020422511de91b2bc7386083}{tx\_buff\_head} = \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.
      \hyperlink{a00030_a6287e1447d7902b8bbc2f6359065dcbd}{tx\_buff\_tail} = 0;
00203 
00204     \hyperlink{a00030_af15ca641f181de14f789d97b00c367ef}{serial\_enable\_blocking}(\hyperlink{a00040_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
00205     \hyperlink{a00030_a7fc7421ed15d6e4516e9878e7455d715}{serial\_get\_command\_ack}();
00206 
00207 
00208 
00209 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=302pt]{d5/d79/a00030_ad2b461e9e9044364a28a61cfadcacdd8_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=212pt]{d5/d79/a00030_ad2b461e9e9044364a28a61cfadcacdd8_icgraph}
\end{center}
\end{figure}


\hypertarget{a00030_abc17de32f14103a5be219df0d4ad9176}{\index{srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}!serial\+\_\+make16@{serial\+\_\+make16}}
\index{serial\+\_\+make16@{serial\+\_\+make16}!srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}}
\subsubsection[{serial\+\_\+make16}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Uint16} serial\+\_\+make16 (
\begin{DoxyParamCaption}
\item[{{\bf Uint8} $\ast$}]{buf, }
\item[{{\bf Uint16}}]{idx}
\end{DoxyParamCaption}
)}}\label{a00030_abc17de32f14103a5be219df0d4ad9176}


Function converting characters to 16 bit value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em buf} & buffer with characters \\
\hline
\mbox{\tt in}  & {\em idx} & index to first character of 16 bit hex number string ( four charaters used) \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{a00030_source_l00381}{381} of file \hyperlink{a00030_source}{srv\+\_\+serial.\+c}.



References \hyperlink{a00030_source_l00016}{H\+E\+X2\+V\+A\+L}.



Referenced by \hyperlink{a00038_source_l00950}{msg\+\_\+to\+\_\+mem()}, and \hyperlink{a00030_source_l00263}{serial\+\_\+get\+\_\+command()}.


\begin{DoxyCode}
00382 \{
00383     \textcolor{keywordflow}{return} ((\hyperlink{a00030_a428b04d2e2f2da2ea031a6c731660a71}{HEX2VAL}(buf[idx+0])<<12)|(\hyperlink{a00030_a428b04d2e2f2da2ea031a6c731660a71}{HEX2VAL}(buf[idx+1])<<8)|(
      \hyperlink{a00030_a428b04d2e2f2da2ea031a6c731660a71}{HEX2VAL}(buf[idx+2])<<4)|(\hyperlink{a00030_a428b04d2e2f2da2ea031a6c731660a71}{HEX2VAL}(buf[idx+3])<<0));
00384 
00385 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=303pt]{d5/d79/a00030_abc17de32f14103a5be219df0d4ad9176_icgraph}
\end{center}
\end{figure}


\hypertarget{a00030_aa76f5237babd71f1484bb2dbc6aa0f8d}{\index{srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}!serial\+\_\+make8@{serial\+\_\+make8}}
\index{serial\+\_\+make8@{serial\+\_\+make8}!srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}}
\subsubsection[{serial\+\_\+make8}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Uint8} serial\+\_\+make8 (
\begin{DoxyParamCaption}
\item[{{\bf Uint8} $\ast$}]{buf, }
\item[{{\bf Uint16}}]{idx}
\end{DoxyParamCaption}
)}}\label{a00030_aa76f5237babd71f1484bb2dbc6aa0f8d}


Function converting characters to 8 bit value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em buf} & buffer with characters \\
\hline
\mbox{\tt in}  & {\em idx} & index to first character of 8 bit hex number string ( two characters used ) \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{a00030_source_l00367}{367} of file \hyperlink{a00030_source}{srv\+\_\+serial.\+c}.



References \hyperlink{a00030_source_l00016}{H\+E\+X2\+V\+A\+L}.



Referenced by \hyperlink{a00038_source_l00950}{msg\+\_\+to\+\_\+mem()}.


\begin{DoxyCode}
00368 \{
00369     \textcolor{keywordflow}{return} ((\hyperlink{a00030_a428b04d2e2f2da2ea031a6c731660a71}{HEX2VAL}(buf[idx+0])<<4)|(\hyperlink{a00030_a428b04d2e2f2da2ea031a6c731660a71}{HEX2VAL}(buf[idx+1]))<<0);
00370 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=266pt]{d5/d79/a00030_aa76f5237babd71f1484bb2dbc6aa0f8d_icgraph}
\end{center}
\end{figure}


\hypertarget{a00030_a17f65cf9dbacdfb97cb2536ed0097ccb}{\index{srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}!serial\+\_\+send@{serial\+\_\+send}}
\index{serial\+\_\+send@{serial\+\_\+send}!srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}}
\subsubsection[{serial\+\_\+send}]{\setlength{\rightskip}{0pt plus 5cm}void serial\+\_\+send (
\begin{DoxyParamCaption}
\item[{void $\ast$}]{msg, }
\item[{{\bf Uint16}}]{length}
\end{DoxyParamCaption}
)}}\label{a00030_a17f65cf9dbacdfb97cb2536ed0097ccb}


Function sending buffers over serial port. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em buffer} & character buffer to be sent \\
\hline
\mbox{\tt in}  & {\em length} & buffer length \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{a00030_source_l00577}{577} of file \hyperlink{a00030_source}{srv\+\_\+serial.\+c}.



References \hyperlink{a00030_source_l00039}{serial\+\_\+data\+\_\+t\+::blocking\+\_\+mode}, \hyperlink{a00033_a3b0017f6ec0e04a6435bba00fe325294}{Delay5us()}, \hyperlink{a00040_source_l00086}{F\+A\+L\+S\+E}, \hyperlink{a00031_source_l00024}{T\+R\+A\+N\+S\+M\+I\+T\+\_\+\+B\+U\+F\+F\+E\+R\+\_\+\+S\+I\+Z\+E}, \hyperlink{a00040_source_l00084}{T\+R\+U\+E}, \hyperlink{a00030_source_l00044}{serial\+\_\+data\+\_\+t\+::tx\+\_\+buff\+\_\+head}, \hyperlink{a00030_source_l00046}{serial\+\_\+data\+\_\+t\+::tx\+\_\+buff\+\_\+tail}, and \hyperlink{a00030_source_l00042}{serial\+\_\+data\+\_\+t\+::tx\+\_\+buffer}.



Referenced by \hyperlink{a00030_source_l00412}{serial\+\_\+send\+\_\+response()}.


\begin{DoxyCode}
00578 \{
00579   
00580     \hyperlink{a00072_a59a9f6be4562c327cbfb4f7e8e18f08b}{Uint16} TrNewHead;
00581     \hyperlink{a00072_af84840501dec18061d18a68c162a8fa2}{Uint8}  dummy;
00582 
00583     \hyperlink{a00072_ab151ad5c5a3b673cb8815c87ed7f706c}{CChar} * buffer = (\hyperlink{a00072_ab151ad5c5a3b673cb8815c87ed7f706c}{CChar} *)msg;
00584 
00585 
00586     IEC0bits.U1TXIE    = 0;
00587 
00588     serial\_enable\_transmitter(\hyperlink{a00040_aa8cecfc5c5c054d2875c03e77b7be15d}{TRUE});
00589 
00590     \hyperlink{a00033_a3b0017f6ec0e04a6435bba00fe325294}{Delay5us}(100);
00591     
00592     \textcolor{keywordflow}{while}((U1STAbits.URXDA != 0))dummy = U1RXREG;
00593     
00594 
00595 
00596     \textcolor{keywordflow}{if}(length > 0)
00597     \{
00598         \textcolor{keywordflow}{if}(\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_a6287e1447d7902b8bbc2f6359065dcbd}{tx\_buff\_tail} == \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.
      \hyperlink{a00030_a3e2eda0a020422511de91b2bc7386083}{tx\_buff\_head})
00599         \{
00600             \textcolor{comment}{// Launch transmission ( if not already in progress )}
00601             \textcolor{keywordflow}{while}(U1STAbits.UTXBF!=0)\textcolor{keywordflow}{continue}; \textcolor{comment}{// wait unitl FIFO is available}
00602             U1TXREG = *buffer;
00603             buffer++;
00604             length--;
00605         \}
00606     \}
00607 
00608     \textcolor{keywordflow}{while} (length > 0)
00609     \{
00610         TrNewHead = (\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_a3e2eda0a020422511de91b2bc7386083}{tx\_buff\_head} + 1)%
      \hyperlink{a00031_aef714b16a48390956c10e8aa18d156b8}{TRANSMIT\_BUFFER\_SIZE};
00611 
00612         \textcolor{keywordflow}{if}(TrNewHead != \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_a6287e1447d7902b8bbc2f6359065dcbd}{tx\_buff\_tail})
00613         \{
00614             \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_a327864d2719b5145f0eded883fe321c5}{tx\_buffer}[\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.
      \hyperlink{a00030_a3e2eda0a020422511de91b2bc7386083}{tx\_buff\_head}] = *buffer;
00615             buffer++;
00616             length--;
00617             \hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_a3e2eda0a020422511de91b2bc7386083}{tx\_buff\_head} = TrNewHead;
00618         \}
00619         \textcolor{keywordflow}{else}
00620         \{
00621             \textcolor{keywordflow}{if}(\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_a758ac775caab1899af08024d4635f7e3}{blocking\_mode} == 0)
00622             \{
00623                 \textcolor{comment}{// Cut the message - does not fit into buffer :-(}
00624                 length = 0;
00625             \}
00626             \textcolor{keywordflow}{else}
00627             \{
00628                 IEC0bits.U1TXIE   = 1;
00629                 serial\_wait\_sent();
00630                 IEC0bits.U1TXIE   = 0;
00631 
00632                 serial\_enable\_transmitter(\hyperlink{a00040_aa93f0eb578d23995850d61f7d61c55c1}{FALSE});
00633 
00634                 \textcolor{keywordflow}{while}((U1STAbits.URXDA != 0))dummy = U1RXREG;
00635                 IEC0bits.U1RXIE   = 1;
00636                 length = 0;
00637             \}
00638         \}
00639 
00640     \}
00641 
00642     IEC0bits.U1TXIE   = 1;
00643 
00644 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=239pt]{d5/d79/a00030_a17f65cf9dbacdfb97cb2536ed0097ccb_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=293pt]{d5/d79/a00030_a17f65cf9dbacdfb97cb2536ed0097ccb_icgraph}
\end{center}
\end{figure}


\hypertarget{a00030_a96a3f016ca5b0736424c2695fe9fbdf8}{\index{srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}!serial\+\_\+send\+\_\+response@{serial\+\_\+send\+\_\+response}}
\index{serial\+\_\+send\+\_\+response@{serial\+\_\+send\+\_\+response}!srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}}
\subsubsection[{serial\+\_\+send\+\_\+response}]{\setlength{\rightskip}{0pt plus 5cm}void serial\+\_\+send\+\_\+response (
\begin{DoxyParamCaption}
\item[{{\bf serial\+\_\+msg\+\_\+t}}]{msg}
\end{DoxyParamCaption}
)}}\label{a00030_a96a3f016ca5b0736424c2695fe9fbdf8}


Function sending command responses on serial line. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em cmd} & response command \\
\hline
\mbox{\tt in}  & {\em arg} & response argument\\
\hline
\end{DoxyParams}
Function sending command responses on serial line.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em cmd} & response command \\
\hline
\mbox{\tt in}  & {\em arg} & response argument \\
\hline
\end{DoxyParams}


Definition at line \hyperlink{a00030_source_l00412}{412} of file \hyperlink{a00030_source}{srv\+\_\+serial.\+c}.



References \hyperlink{a00031_source_l00030}{serial\+\_\+msg\+\_\+t\+::arg}, \hyperlink{a00031_source_l00031}{serial\+\_\+msg\+\_\+t\+::arg\+\_\+cnt}, \hyperlink{a00072_source_l00059}{A\+S\+S\+E\+R\+T}, \hyperlink{a00031_a040f6d5d58d18d8aeaf447eda7f50172}{serial\+\_\+msg\+\_\+t\+::attachment}, \hyperlink{a00031_source_l00029}{serial\+\_\+msg\+\_\+t\+::cmd}, \hyperlink{a00060_source_l00084}{crc16()}, \hyperlink{a00030_source_l00031}{serial\+\_\+data\+\_\+t\+::rc\+\_\+buffer}, and \hyperlink{a00030_source_l00577}{serial\+\_\+send()}.


\begin{DoxyCode}
00413 \{
00414   
00415     \textcolor{comment}{// \{CMD:CHSN00000000....:crc\}}
00416     \textcolor{comment}{// 0123456789012345}
00417     \textcolor{comment}{// 0000000000111111}
00418 
00419 
00420 
00421    \textcolor{comment}{//during this time i.e. while processing command, all incoming messages are ignored}
00422    \textcolor{comment}{//hence, the receive buffer will be used temporarily while preparing response msg}
00423 
00424    \textcolor{keywordtype}{char}   *message = (\textcolor{keywordtype}{char} *)(\hyperlink{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{serial\_data}.\hyperlink{a00030_ac734cb8be27f86bd99edc539434883a4}{rc\_buffer});
00425 
00426    \hyperlink{a00072_a59a9f6be4562c327cbfb4f7e8e18f08b}{Uint16}  length = 0;
00427 
00428 
00429   \hyperlink{a00072_a59a9f6be4562c327cbfb4f7e8e18f08b}{Uint16} type =  (((msg.\hyperlink{a00031_a13c351e37c82b2434e5ce4421012ffd6}{cmd}&0x00F0)>>4)== 0xE)?0xE:
00430                  ((((msg.\hyperlink{a00031_a13c351e37c82b2434e5ce4421012ffd6}{cmd}&0x0F00)>>8)==6)?6:3);
00431 
00432  \textcolor{keywordflow}{if}(msg.\hyperlink{a00031_a040f6d5d58d18d8aeaf447eda7f50172}{attachment}.length > 0)type = 0xE; \textcolor{keywordflow}{else} type = msg.\hyperlink{a00031_a7b79f40e2eeec288091afd340bf8f591}{arg\_cnt};
00433 
00434  \textcolor{keywordflow}{switch}(type)
00435    \{
00436        \textcolor{keywordflow}{case} 3\textcolor{comment}{/*3 arg msg*/}:
00437        \{
00438 
00439        sprintf(message,\textcolor{stringliteral}{"\{%04X:%02X%02X%04X:"},msg.\hyperlink{a00031_a13c351e37c82b2434e5ce4421012ffd6}{cmd},msg.\hyperlink{a00031_af7d6f762438c80072bd9dc0e4dd4ae1e}{arg}[0],msg.\hyperlink{a00031_af7d6f762438c80072bd9dc0e4dd4ae1e}{arg}[1],msg.
      \hyperlink{a00031_af7d6f762438c80072bd9dc0e4dd4ae1e}{arg}[2]);
00440 
00441        sprintf(message+15,\textcolor{stringliteral}{"%04X\}"},\hyperlink{a00021_a6553827687db2137ee550ad6e1d2f316}{crc16}((\hyperlink{a00072_af84840501dec18061d18a68c162a8fa2}{Uint8}*)message,14));
00442 
00443        length = 20;
00444        \}\textcolor{keywordflow}{break};
00445 
00446 
00447        \textcolor{keywordflow}{case} 4\textcolor{comment}{/*4 arg msg*/}:
00448        \{    sprintf(message,\textcolor{stringliteral}{"\{%04X:%02X%02X%04X%04X:"},msg.\hyperlink{a00031_a13c351e37c82b2434e5ce4421012ffd6}{cmd},msg.\hyperlink{a00031_af7d6f762438c80072bd9dc0e4dd4ae1e}{arg}[0],msg.
      \hyperlink{a00031_af7d6f762438c80072bd9dc0e4dd4ae1e}{arg}[1],msg.\hyperlink{a00031_af7d6f762438c80072bd9dc0e4dd4ae1e}{arg}[2],msg.\hyperlink{a00031_af7d6f762438c80072bd9dc0e4dd4ae1e}{arg}[3]);
00449 
00450        sprintf(message+19,\textcolor{stringliteral}{"%04X\}"},\hyperlink{a00021_a6553827687db2137ee550ad6e1d2f316}{crc16}((\hyperlink{a00072_af84840501dec18061d18a68c162a8fa2}{Uint8}*)message,18));
00451 
00452        length = 24;
00453 
00454        \}\textcolor{keywordflow}{break};
00455 
00456 
00457        \textcolor{keywordflow}{case} 0xE \textcolor{comment}{/*data transfer*/}:
00458        \{
00459 
00460        \textcolor{keyword}{const} \textcolor{keywordtype}{char} cnv[] = \textcolor{stringliteral}{"0123456789ABCDEF"};
00461 
00462        memset(message,0,\textcolor{keyword}{sizeof}(message));
00463 
00464        sprintf(message,\textcolor{stringliteral}{"\{%04X:%02X%02X%04X%04X"},msg.\hyperlink{a00031_a13c351e37c82b2434e5ce4421012ffd6}{cmd},
00465                                             msg.\hyperlink{a00031_af7d6f762438c80072bd9dc0e4dd4ae1e}{arg}[0],msg.\hyperlink{a00031_af7d6f762438c80072bd9dc0e4dd4ae1e}{arg}[1],
00466                                             msg.\hyperlink{a00031_af7d6f762438c80072bd9dc0e4dd4ae1e}{arg}[2],msg.\hyperlink{a00031_af7d6f762438c80072bd9dc0e4dd4ae1e}{arg}[3]);
00467 
00468        \textcolor{comment}{//if(msg.attachment.offset == 0)}
00469        \textcolor{comment}{//  memcpy((void *)((void *)&pre\_data + msg.attachment.offset),(void *)(msg.attachment.location +
       msg.attachment.offset),sizeof(pre\_act\_record\_buffer\_t));}
00470 
00471        \hyperlink{a00072_a59a9f6be4562c327cbfb4f7e8e18f08b}{Uint16} var;
00472        \hyperlink{a00072_a59a9f6be4562c327cbfb4f7e8e18f08b}{Uint16} cc = 0;
00473 \textcolor{comment}{/*}
00474 \textcolor{comment}{       for (var = 18; cc < msg.attachment.length; ) \{}
00475 \textcolor{comment}{}
00476 \textcolor{comment}{                   message[var]   =}
00477 \textcolor{comment}{                    cnv[(*((((Uint8 *)&pre\_data + msg.attachment.offset))+(cc))>>4)&0x0F];}
00478 \textcolor{comment}{}
00479 \textcolor{comment}{                   message[var+1]   =}
00480 \textcolor{comment}{                    cnv[(*((((Uint8 *)&pre\_data + msg.attachment.offset))+(cc++))>>0)&0x0F];}
00481 \textcolor{comment}{}
00482 \textcolor{comment}{                   var+=2;}
00483 \textcolor{comment}{       \}}
00484 \textcolor{comment}{*/}
00485    
00486        \textcolor{keywordflow}{for} (var = 18; cc < msg.\hyperlink{a00031_a040f6d5d58d18d8aeaf447eda7f50172}{attachment}.length; ) \{
00487 
00488                    message[var]   =
00489                     cnv[(*((((\hyperlink{a00072_af84840501dec18061d18a68c162a8fa2}{Uint8} *)msg.\hyperlink{a00031_a040f6d5d58d18d8aeaf447eda7f50172}{attachment}.location + msg.
      \hyperlink{a00031_a040f6d5d58d18d8aeaf447eda7f50172}{attachment}.offset))+(cc))>>4)&0x0F];
00490 
00491                    message[var+1]   =
00492                     cnv[(*((((\hyperlink{a00072_af84840501dec18061d18a68c162a8fa2}{Uint8} *)msg.\hyperlink{a00031_a040f6d5d58d18d8aeaf447eda7f50172}{attachment}.location + msg.
      \hyperlink{a00031_a040f6d5d58d18d8aeaf447eda7f50172}{attachment}.offset))+(cc++))>>0)&0x0F];
00493 
00494                    var+=2;
00495        \}
00496 
00497   
00498      
00499 
00500        message[var++]=\textcolor{charliteral}{':'};
00501 
00502        sprintf(message+var,\textcolor{stringliteral}{"%04X\}"},\hyperlink{a00021_a6553827687db2137ee550ad6e1d2f316}{crc16}((\hyperlink{a00072_af84840501dec18061d18a68c162a8fa2}{Uint8}*)message,var-1));
00503 
00504        length = var+5;
00505        
00506        \}\textcolor{keywordflow}{break};
00507 
00508 
00509         \textcolor{keywordflow}{default}:
00510         \{
00511 
00512             \hyperlink{a00072_abb8ff8e213ac9f6fb21d2b968583b936}{ASSERT}(0);
00513         \}
00514 
00515  \}
00516 
00517 
00518 
00519     \hyperlink{a00030_a17f65cf9dbacdfb97cb2536ed0097ccb}{serial\_send}(message,length);
00520 \}
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d79/a00030_a96a3f016ca5b0736424c2695fe9fbdf8_cgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\hypertarget{a00030_a448db071f92912b830a4aabd08c45d0c}{\index{srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}!pre\+\_\+data@{pre\+\_\+data}}
\index{pre\+\_\+data@{pre\+\_\+data}!srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}}
\subsubsection[{pre\+\_\+data}]{\setlength{\rightskip}{0pt plus 5cm}{\bf pre\+\_\+act\+\_\+record\+\_\+buffer\+\_\+t} pre\+\_\+data}}\label{a00030_a448db071f92912b830a4aabd08c45d0c}


Definition at line \hyperlink{a00030_source_l00025}{25} of file \hyperlink{a00030_source}{srv\+\_\+serial.\+c}.

\hypertarget{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}{\index{srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}!serial\+\_\+data@{serial\+\_\+data}}
\index{serial\+\_\+data@{serial\+\_\+data}!srv\+\_\+serial.\+c@{srv\+\_\+serial.\+c}}
\subsubsection[{serial\+\_\+data}]{\setlength{\rightskip}{0pt plus 5cm}volatile {\bf serial\+\_\+data\+\_\+t} serial\+\_\+data}}\label{a00030_a77d3b77ccd59a0065642bf1ac7887b9d}


srv\+\_\+serial service internal data 



Definition at line \hyperlink{a00030_source_l00078}{78} of file \hyperlink{a00030_source}{srv\+\_\+serial.\+c}.

